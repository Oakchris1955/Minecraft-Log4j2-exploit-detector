#import libraries
import os, gzip, time

#import tkinter
import tkinter as tk

# install libraries to render image
from PIL import Image, ImageTk

#get the name of current user
username = os.environ.get('USERNAME')

#set the exploit dictionary
exploit_dict = {}
exploit_found = False

#add the log's content to exploit_dict
if os.path.isdir(f"C:/Users/{username}/AppData/Roaming/.minecraft/logs"):
	for root, directories, file in os.walk(f'C:/Users/{username}/AppData/Roaming/.minecraft/logs'):
		for file in file:
			if(file.endswith(".txt.gz")):
				with gzip.open(f'C:/Users/{username}/AppData/Roaming/.minecraft/logs/{file}', 'rb') as f:
					file_content = f.read()
					#print(file_content.decode('UTF-8'))
					exploit_dict[file] = file_content.decode('UTF-8')

#check the exploit dir for any strings that refer to the exploit
for i, x  in exploit_dict.items():
	if 'jndi:ldap' in x:
		print('Found an exploit reference in file :',i)
		exploit_found = True

#set the window
window = tk.Tk()

#check if an exploit reference was found
if exploit_found:
	load = Image.open("warning.png")
	text_for_label = 'Warning!!! An exploit reference was found'
else:
	load = Image.open("checkmark.png")
	text_for_label = 'No exploit reference was found'

#set the rest of the GUI
render = ImageTk.PhotoImage(load)
img = tk.Label(image=render)
img.pack()

textlabel = tk.Label(text=text_for_label, font=("Arial", 20))
textlabel.pack()

#render the GUI
window.mainloop()