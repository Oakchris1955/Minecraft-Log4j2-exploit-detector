#import libraries
import os, gzip

#get the name of current user
username = os.environ.get('USERNAME')

#set the exploit dictionary
exploit_dict = {}
exploit_found = False

#add the log's content to exploit_dict
if os.path.isdir(f"C:/Users/{username}/Desktop/Test"):
	for root, directories, file in os.walk(f'C:/Users/{username}/Desktop/Test'):
		for file in file:
			if(file.endswith(".txt.gz")):
				with gzip.open(f'C:/Users/{username}/Desktop/Test/{file}', 'rb') as f:
					file_content = f.read()
					#print(file_content.decode('UTF-8'))
					exploit_dict[file] = file_content.decode('UTF-8')

#check the exploit dir for any strings that refer to the exploit
for i, x  in exploit_dict.items():
	if 'jndi:ldap' in x:
		print('Found an exploit reference in file :',i)
		exploit_found = True

if exploit_found:
	print('One or more exploit references were found')
else:
	print('No exploit reference found')